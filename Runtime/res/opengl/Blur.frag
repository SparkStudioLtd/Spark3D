#version 330 core
out vec4 FragColor;
  
in vec2 texCoord;

uniform sampler2D image;
  
uniform bool horizontal;

const int SAMPLE_COUNT = 65;

const float OFFSETS[65] = float[65](
    -63.438332847387024,
    -61.440255257896155,
    -59.44217954860998,
    -57.444105669514336,
    -55.446033569825104,
    -53.447963197810616,
    -51.44989450059458,
    -49.451827423936564,
    -47.453761911999386,
    -45.45569790710268,
    -43.45763534947751,
    -41.45957417703015,
    -39.461514325137124,
    -37.463455726495,
    -35.4653983110599,
    -33.46734200612031,
    -31.469286736558313,
    -29.47123242536565,
    -27.47317899449017,
    -25.47512636609167,
    -23.477074464275574,
    -21.479023217336046,
    -19.48097256045373,
    -17.48292243861854,
    -15.484872809220015,
    -13.486823643156159,
    -11.488774922273269,
    -9.490726629154937,
    -7.4926787222117985,
    -5.494631083814344,
    -3.496583420392626,
    -1.4985350785178284,
    0.4995108475675555,
    2.497559396787363,
    4.49560728468456,
    6.4936548820396585,
    8.491702632112665,
    10.489750723839654,
    12.487799227975632,
    14.48584816959321,
    16.48389756449537,
    18.481947435633163,
    20.479997818839735,
    22.478048763192906,
    24.47610032897032,
    26.474152584794115,
    28.472205604776082,
    30.47025946603214,
    32.46831424669394,
    34.46637002442127,
    36.464426875360516,
    38.4624848734733,
    40.46054409015676,
    42.45860459408417,
    44.456666451204924,
    46.45472972485469,
    48.45279447593685,
    50.45086076314536,
    52.44892864320806,
    54.446998171133956,
    56.445069400452525,
    58.44314238344245,
    60.44121717133761,
    62.439293814516404,
    64
);

const float WEIGHTS[65] = float[65](
    0.000019135619542579903,
    0.00003115998654033693,
    0.000049955036195035974,
    0.00007884756181161416,
    0.00012252477204462237,
    0.0001874501688738747,
    0.0002823408418789221,
    0.00041868474636818194,
    0.0006112596912211396,
    0.0008785959197245408,
    0.001243303158720577,
    0.001732163807350593,
    0.0023758805833829543,
    0.0032083642445562997,
    0.004265459877325021,
    0.005583042805732444,
    0.007194469577215746,
    0.009127444777570989,
    0.011400455632116634,
    0.014019024071005977,
    0.01697211679145773,
    0.020229121851161713,
    0.023737829200591476,
    0.027423828735949993,
    0.0311916552341453,
    0.03492786579920523,
    0.038506043202063606,
    0.04179349864755312,
    0.04465922869108407,
    0.04698249555815756,
    0.048661278645421385,
    0.049619810879441104,
    0.049813922335798594,
    0.04923411076782136,
    0.047907877050345465,
    0.045895579662830366,
    0.043286967662135765,
    0.040194437640829,
    0.03674494319630653,
    0.03307138061258154,
    0.029304231984130027,
    0.025564166959791877,
    0.021956147308357085,
    0.018565372298576965,
    0.01545517963390444,
    0.012666807462390602,
    0.010220752970379932,
    0.008119348367981914,
    0.006350121529805515,
    0.00488951247961074,
    0.00370656728553572,
    0.0027663124411580003,
    0.00203260897515241,
    0.0014703814394175533,
    0.0010472010734646955,
    0.0007342676468119148,
    0.0005068778621917706,
    0.0003444905002174196,
    0.0002305029838495649,
    0.0001518453876564323,
    0.00009848107405076465,
    0.00006288259006743954,
    0.00003953073398549648,
    0.000024466196852322758,
    0.000008387770600613822
);


vec4 blur(in sampler2D sourceTexture, vec2 blurDirection, vec2 pixelCoord)
{
    vec4 result = vec4(0.0);
    vec2 size = textureSize(sourceTexture, 0);
    for (int i = 0; i < SAMPLE_COUNT; ++i)
    {
        vec2 offset = blurDirection * OFFSETS[i] / size;
        float weight = WEIGHTS[i];
        result += texture(sourceTexture, pixelCoord + offset) * weight;
    }
    return result;
}

void main()
{             
    if(horizontal) {
        FragColor = blur(image,vec2(1,0),texCoord);
    } else {
        FragColor = blur(image,vec2(0,1),texCoord);
    }
}